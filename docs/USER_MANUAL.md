# D2trader 사용자 매뉴얼

> 버전: 2026-02-19
> 대상: 대시보드를 통해 퀀트 전략을 모니터링하고 시뮬레이션하려는 사용자

---

## 목차

1. [D2trader란?](#1-d2trader란)
2. [접속 방법](#2-접속-방법)
3. [화면 구성 한눈에 보기](#3-화면-구성-한눈에-보기)
4. [자산 현황 탭](#4-자산-현황-탭)
5. [벤치마크 탭](#5-벤치마크-탭)
6. [전략 설정 탭](#6-전략-설정-탭)
7. [백테스트 탭](#7-백테스트-탭)
8. [모의거래 탭](#8-모의거래-탭)
9. [실행 & 제어 탭](#9-실행--제어-탭)
10. [일상 운영 가이드](#10-일상-운영-가이드)
11. [전략 소개](#11-전략-소개)
12. [자주 묻는 질문](#12-자주-묻는-질문)
13. [문제 해결](#13-문제-해결)
14. [알려진 제한사항](#14-알려진-제한사항)

---

## 1. D2trader란?

D2trader는 한국/미국 주식을 대상으로 퀀트 전략을 자동 실행하는 트레이딩 대시보드입니다.

할 수 있는 일:
- 포트폴리오 현황과 수익률을 실시간으로 확인
- KOSPI, S&P500 등 시장 지수와 내 수익률 비교
- 과거 데이터로 전략을 백테스트
- 실제 돈 없이 모의거래(페이퍼 트레이딩)로 전략 검증
- 전략 파라미터를 화면에서 직접 편집
- Kill Switch로 언제든 거래를 즉시 중단

**기본 모드는 "모의투자"입니다.** 실거래 전환은 별도의 확인 과정을 거칩니다.

---

## 2. 접속 방법

웹 브라우저에서 관리자가 알려준 주소로 접속합니다.

- 로컬 환경: `http://localhost:3000`
- 외부 접속: `https://d2trader.your-domain.com` (배포 시 관리자가 안내)

별도 로그인 없이 접속됩니다. 추가 소프트웨어 설치는 필요 없습니다.

---

## 3. 화면 구성 한눈에 보기

상단 헤더에 현재 모드("모의" 또는 "실거래")와 Kill Switch 상태가 표시됩니다.
그 아래 6개 탭으로 이동합니다.

| 탭 | 이름 | 용도 |
|----|------|------|
| 1 | **자산 현황** | 보유 종목, 수익률, 리스크 지표 확인 |
| 2 | **벤치마크** | 시장 지수 대비 성과 비교 |
| 3 | **전략 설정** | 전략 ON/OFF, 파라미터 편집 |
| 4 | **백테스트** | 과거 데이터로 전략 성과 시뮬레이션 |
| 5 | **모의거래** | 가상 자금으로 전략 실행 테스트 |
| 6 | **실행 & 제어** | 봇 실행, 모드 전환, Kill Switch |

---

## 4. 자산 현황 탭

포트폴리오의 현재 상태를 한눈에 보여줍니다.

### 자본금 설정

화면 상단에서 초기자본과 현금을 확인할 수 있습니다.

- **설정**: 원하는 금액을 입력하고 "설정" 버튼을 누르면 초기자본이 변경됩니다.
- **리셋**: 모든 포지션을 청산하고 자본금을 초기 상태로 되돌립니다. 확인 팝업이 뜹니다.

### 핵심 지표 (4개 카드)

- **총자산**: 현재 보유 자산 합계
- **일일 손익**: 오늘의 수익/손실 금액 (초록색 = 이익, 빨간색 = 손실)
- **현금 비중**: 전체 자산 중 현금 비율과 보유 포지션 수
- **드로다운**: 최고점 대비 현재 하락 폭

### 보유 종목 목록

"국내"와 "해외" 버튼으로 시장을 전환합니다.

표시 항목: 종목명, 코드, 수량, 평균 매수가, 현재가, 수익률(%), 평가손익(원)

### 리스크 지표

현재 설정된 리스크 한도와 실제 수치를 비교 표시합니다.

---

## 5. 벤치마크 탭

내 포트폴리오 수익률을 시장 지수와 비교합니다.

### 수익률 비교

화면 상단에 3개 배지가 나란히 표시됩니다: 포트폴리오, KOSPI, S&P500

### 비교 차트

기간을 선택하면(3개월, 6개월, 1년 등) 내 수익률과 시장 지수를 겹쳐 보여줍니다.

### 알파 / 베타

- **알파**: 시장 대비 내 초과 수익률 (양수면 시장보다 잘한 것)
- **베타**: 시장 변동에 대한 내 포트폴리오의 민감도 (1보다 크면 시장보다 변동성이 큰 것)

---

## 6. 전략 설정 탭

현재 등록된 전략을 관리합니다.

### 전략 목록

각 전략이 카드로 표시됩니다:
- **ON/OFF 토글**: 전략 활성화/비활성화
- **파라미터 편집**: 버튼을 누르면 편집 화면 열림
- **삭제**: 전략을 완전히 제거 (되돌릴 수 없음)
- **순서 변경**: 카드를 드래그하여 순서를 변경할 수 있습니다

### 파라미터 편집 화면

전략 종류에 따라 편집 항목이 달라집니다.

**숫자 파라미터** (모든 전략 공통): lookback_window, entry_z_score 등 수치 직접 입력

**페어 편집** (Stat Arb 전략):
- 종목 A, 종목 B, 헤지 ETF 코드를 입력
- 시장 선택 (KR / US)
- "페어 추가" 버튼으로 새 페어 등록
- 각 페어 옆 삭제 아이콘으로 제거

**종목 유니버스 편집** (Quant Factor 전략):
- 종목 코드, 시장, 종목명 입력
- "종목 추가" 버튼으로 등록

편집 후 "저장" 버튼을 누르면 즉시 반영됩니다.

### 새 전략 만들기

우측 상단 "+ 새 전략 만들기" 버튼으로 새 전략을 추가할 수 있습니다.

---

## 7. 백테스트 탭

과거 데이터로 전략이 실제로 수익을 냈을지 시뮬레이션합니다.

### 실행 방법

1. **전략 선택**: 드롭다운에서 테스트할 전략 선택
2. **페어 선택** (선택사항): Stat Arb의 경우 특정 페어만 테스트 가능. "전체"를 선택하면 모든 페어를 함께 테스트
3. **기간 설정**: 시작일과 종료일 입력 (예: 2022-01-01 ~ 2025-12-31)
4. **초기 자본금**: 기본 1,000만원. 변경 가능
5. **"백테스트 실행"** 버튼 클릭

### 결과 화면

실행이 완료되면 다음 결과가 표시됩니다:

- **핵심 지표 카드**: 총수익률, 연환산수익률(CAGR), 샤프비율, 최대낙폭(MDD), 승률
- **자산 곡선 차트**: 자본금이 시간에 따라 어떻게 변했는지
- **드로다운 차트**: 고점 대비 하락 구간 시각화
- **월별 히트맵**: 월별 수익률을 색상으로 표시 (초록 = 이익, 빨강 = 손실)
- **손익 분포**: 개별 거래 손익의 히스토그램
- **거래 내역 테이블**: 모든 매매 기록 (날짜, 종목, 방향, 수량, 가격, 손익)
- **실행 로그**: 전략이 왜 그 시점에 매수/매도 신호를 냈는지 설명

### 팁

- 기간이 길수록 (3년 이상) 결과가 신뢰할 만합니다
- 같은 전략을 파라미터만 바꿔서 여러 번 돌려보면 민감도를 파악할 수 있습니다
- Stat Arb는 페어별로 따로 돌려보는 것이 유용합니다

---

## 8. 모의거래 탭

실제 돈 없이 전략 신호를 가상으로 실행해봅니다.

### 세션 시작

1. "새 세션 시작" 버튼 클릭 → 활성 세션이 생성됩니다
2. 세션 ID와 참여 전략이 표시됩니다

### 시그널 미리보기

활성 세션이 있으면 전략별로 신호가 표시됩니다:
- 종목 코드, 매수(BUY)/매도(SELL) 배지, 시장(KR/US)
- 예상 수량과 가격
- 신호 발생 이유 (예: "듀얼 모멘텀: US 선택 (KR=2.1%, US=8.5%)")

"시그널 새로고침" 버튼으로 최신 신호를 다시 불러올 수 있습니다.

### 모의 실행

"전체 모의 실행" 버튼을 누르면 모든 신호가 가상으로 체결됩니다.
체결 결과는 하단 "거래 내역" 테이블에 표시됩니다.

### 세션 종료

"세션 종료" 버튼으로 현재 세션을 마칩니다. 종료된 세션은 히스토리에 남습니다.

---

## 9. 실행 & 제어 탭

봇의 실행과 안전장치를 관리합니다.

### 모드 전환

화면 우측 상단에 두 가지 모드 버튼이 있습니다:
- **모의투자** (파란색): 가상 거래만 실행. 기본 모드
- **실거래** (빨간색): 실제 계좌에서 주문 실행

실거래 모드 전환 시 확인 팝업이 뜹니다: "실거래 모드에서는 실제 주문이 실행됩니다."

### Kill Switch

모든 전략 실행을 즉시 중단하는 비상 버튼입니다.

- **활성화**: 빨간색 "Kill Switch 활성화" 버튼 클릭 → 확인 팝업 → 모든 거래 중단
- **해제**: 초록색 테두리 "Kill Switch 해제" 버튼 클릭 → 정상 운영 복귀

Kill Switch가 켜진 동안에는 "전체 사이클 실행"과 "데이터 수집" 버튼이 비활성화됩니다.

### 실행 제어

- **전체 사이클 실행**: 데이터 수집 → 전략 분석 → 신호 생성 → 주문 실행을 한 번에 수행
- **데이터 수집**: 시세 데이터만 가져옵니다 (거래는 하지 않음)

실행 결과(성공/실패)가 버튼 위에 표시됩니다.

### 로그 뷰어

하단에 실행 로그가 실시간으로 표시됩니다. 색상으로 구분됩니다:
- 파란색: 정상 정보 (INFO)
- 노란색: 경고 (WARN)
- 빨간색: 오류 (ERROR)

"로그 초기화" 버튼으로 로그를 지울 수 있습니다.

---

## 10. 일상 운영 가이드

### 매일 (5~10분)

1. **자산 현황** 탭에서 총자산, 일일 손익, 보유 종목 확인
2. **실행 & 제어** 탭에서 로그에 에러가 없는지 확인
3. 필요하면 "데이터 수집" 실행

### 매주

1. **벤치마크** 탭에서 시장 대비 성과 확인
2. 알파가 마이너스면 전략 파라미터 점검 고려

### 매월

1. Dual Momentum 전략이 매월 1일 리밸런싱 → 신호가 나왔는지 확인
2. **백테스트** 탭에서 최근 12개월 백테스트로 전략 유효성 점검
3. 필요시 전략 설정 탭에서 파라미터 조정

### 새 전략을 테스트할 때

1. **전략 설정** 탭에서 파라미터 수정 또는 새 전략 추가
2. **백테스트** 탭에서 3년 이상 기간으로 테스트
3. 결과가 만족스러우면 **모의거래** 탭에서 실제 시장 데이터로 검증
4. 충분히 검증된 후 **실행 & 제어** 탭에서 실거래 전환

---

## 11. 전략 소개

### Stat Arb (통계적 차익거래)

두 종목의 가격 관계가 역사적 평균에서 벗어나면 거래합니다.

작동 방식:
1. 두 종목이 장기적으로 함께 움직이는지 확인 (공적분 검정)
2. 가격 차이(스프레드)가 평소보다 크게 벌어지면 진입
3. 스프레드가 평균으로 돌아오면 청산

현재 설정된 페어: KO/PEP, XOM/CVX, V/MA, MSFT/GOOGL

주요 파라미터:
- `lookback_window` (90): Z-Score 계산에 사용할 과거 일수
- `entry_z_score` (1.5): 이 값 이상 벌어지면 진입
- `exit_z_score` (0.5): 이 값 이하로 좁혀지면 청산
- `stop_loss_z_score` (3.0): 이 값 이상 벌어지면 손절
- `coint_pvalue` (0.10): 공적분 검정 기준 (낮을수록 엄격)

### Dual Momentum (듀얼 모멘텀)

한국과 미국 시장 중 더 강한 쪽에 투자합니다.

작동 방식:
1. 한국 ETF(KODEX 200)와 미국 ETF(SPY)의 12개월 수익률 비교
2. 더 높은 쪽을 선택 (상대 모멘텀)
3. 선택된 쪽의 수익률이 무위험수익률(4%)보다 높은지 확인 (절대 모멘텀)
4. 높으면 해당 ETF 매수, 아니면 안전자산(채권 ETF) 매수
5. 매월 1일 리밸런싱

주요 파라미터:
- `lookback_months` (12): 수익률 비교 기간
- `risk_free_rate` (0.04): 무위험수익률 기준 (연 4%)
- `rebalance_day` (1): 매월 리밸런싱 일자

### Quant Factor (퀀트 팩터)

여러 지표(가치, 품질, 모멘텀)를 종합 점수로 매겨 상위 종목에 투자합니다.

작동 방식:
1. 유니버스 전 종목의 일봉 데이터 수집
2. 가치(30%), 품질(30%), 모멘텀(40%) 팩터 계산
3. Z-Score 정규화 → 가중 복합 스코어 산출
4. 상위 종목 매수, 탈락 종목 청산
5. 절대 모멘텀 필터: 하락 추세 종목은 안전자산으로 대체

주요 파라미터:
- `top_n` (20): 보유 종목 수
- `rebalance_months` (1): 리밸런싱 주기 (월)
- `lookback_days` (252): 가치 팩터 룩백 기간

### Volatility Breakout (변동성 돌파)

래리 윌리엄스의 변동성 돌파 전략으로 일중 단타 매매합니다.

작동 방식:
1. 목표가 = 오늘 시가 + 전일 (고가 - 저가) × k
2. 현재가가 목표가 이상이면 매수 (종목당 1회)
3. 장 마감 직전 전량 청산

주요 파라미터:
- `k` (0.8): 변동성 돌파 계수
- `close_at_market_end` (true): 장 종료 시 전량 청산

### Bollinger Band (볼린저 밴드)

볼린저 밴드를 이용한 평균 회귀 전략입니다.

작동 방식:
1. N일 이동평균(SMA)과 상·하단 밴드 계산
2. 종가가 하단 밴드 아래로 내려가면 과매도로 판단하여 매수
3. 종가가 상단 밴드 위로 올라가면 과매수로 판단하여 청산

주요 파라미터:
- `window` (20): SMA 이동평균 기간
- `num_std` (2.0): 표준편차 배수 (밴드 폭)

### Sector Rotation (섹터 로테이션) — 현재 비활성

섹터별 ETF의 모멘텀을 비교하여 상위 섹터에 투자합니다.
전략 설정 탭에서 활성화할 수 있습니다.

---

## 12. 자주 묻는 질문

**Q: 모의투자 모드에서 실제 돈이 빠져나가나요?**
A: 아닙니다. 모의투자 모드에서는 가상 자금으로만 거래합니다. 실제 계좌에는 영향이 없습니다.

**Q: 한국 주식과 미국 주식을 동시에 거래할 수 있나요?**
A: 네. Stat Arb는 미국 주식 페어를, Dual Momentum은 한국+미국 ETF를 거래합니다.

**Q: 전략 파라미터를 바꾸면 바로 적용되나요?**
A: 전략 설정 탭에서 "저장"을 누르면 즉시 반영됩니다. 다음 봇 실행부터 새 파라미터가 적용됩니다.

**Q: 백테스트 결과가 좋으면 실전에서도 수익이 나나요?**
A: 백테스트는 과거 성과이며 미래 수익을 보장하지 않습니다. 모의거래로 충분히 검증한 후 소액부터 시작하는 것을 권장합니다.

**Q: Kill Switch를 켜면 보유 종목이 자동 매도되나요?**
A: 아닙니다. Kill Switch는 "새로운 거래 실행을 중단"하는 것이지, 기존 보유 종목을 자동으로 청산하지는 않습니다.

**Q: 데이터는 얼마나 자주 갱신되나요?**
A: 포트폴리오 데이터는 약 5분 간격으로 갱신됩니다. 즉시 확인이 필요하면 "새로고침" 버튼을 사용하세요.

---

## 13. 문제 해결

### 대시보드가 로딩되지 않을 때

→ 관리자에게 서비스 상태 확인 요청

### "시그널 없음"이 계속 뜰 때

가능한 원인:
- 데이터가 아직 수집되지 않음 → 실행 & 제어 탭에서 "데이터 수집" 실행
- 전략이 비활성화 상태 → 전략 설정 탭에서 ON 확인
- Stat Arb의 경우 공적분 조건 미충족 → 정상 동작일 수 있음 (페어 간 관계가 약할 때)

### 모의 실행했는데 수량이 0주로 나올 때

초기 자본금이 설정되지 않았을 수 있습니다.
자산 현황 탭에서 초기자본을 설정하고 다시 시도해보세요.

### 백테스트가 오래 걸릴 때

→ 기간을 줄여서 실행해보세요. 5년 이상은 다소 시간이 걸릴 수 있습니다.

### 화면에 빨간색 에러 메시지가 뜰 때

→ 에러 메시지 내용을 캡처하고, 실행 & 제어 탭의 로그를 확인한 후 관리자에게 공유해주세요.

---

## 14. 알려진 제한사항

현재 버전의 제한사항입니다.

- **휴일 처리**: 공휴일에 데이터 수집 시 빈 데이터가 반환될 수 있음
- **캐시 지연**: 실행 후 결과 반영까지 최대 5분 소요 (수동 새로고침으로 즉시 확인 가능)
- **실시간 업데이트**: WebSocket 미지원, 폴링 기반 (5분 간격)

이전에 보고된 아래 이슈들은 모두 수정 완료되었습니다:
- ~~모의거래 수량/가격 0 표시~~ → Phase 1 수정 완료
- ~~포지션 현재가 미갱신~~ → Phase 1 수정 완료
- ~~벤치마크 포트폴리오 라인 미연동~~ → Phase 3 수정 완료

수정 이력: `docs/SIMULATION_ISSUES.md` 참조.

---

## 리스크 관리 설정 (참고)

시스템에 사전 설정된 안전장치입니다.

| 항목 | 설정값 | 의미 |
|------|--------|------|
| 최대 포지션 비중 | 10% | 한 종목에 전체 자산의 10%까지만 투자 |
| 손절 기준 | -7% | 개별 종목 -7% 도달 시 자동 손절 |
| 일일 손실 한도 | -2% | 하루 총 손실이 -2% 넘으면 거래 중단 |
| 최대 낙폭 한도 | -10% | 고점 대비 -10% 하락 시 거래 중단 |
| 최대 보유 종목 수 | 10개 | 동시에 10개까지만 포지션 보유 |
| 최소 현금 비중 | 20% | 전체 자산의 20%는 항상 현금으로 유지 |

이 값들은 전략 설정 탭에서 변경할 수 없으며, 관리자가 설정 파일에서 직접 수정합니다.
